<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Partner Information</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600&family=Rajdhani:wght@300;400;600&display=swap"
        rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="style.css">

    <!--  -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css" integrity="sha512-2SwdPD6INVrV/lHTZbO2nodKhrnDdJK9/kg2XD1r9uGqPo1cUbujc+IYdlYdEErWNu69gVcYgdxlmVmzTWnetw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>

<body>
    <div class="container portal-wrap">
        <div class="logo-mark">
            <img src="/images/logo.png" alt="Binghatti Logo">
        </div>

        <div class="form-container d-flex justify-content-center align-items-center gap-5">
            <div class="steps my-5">
                <button type="button" class="step-btn active">Partner Information</button>
                <div class="step-line"></div>
                <button type="button" class="step-btn">Personal &amp; Admin Details</button>
                <div class="step-line"></div>
                <button type="button" class="step-btn">Bank Details</button>
                <div class="step-line"></div>
                <button type="button" class="step-btn">Submit</button>
                <div class="step-line"></div>
                <button type="button" class="step-btn">Binghatti Approval</button>
                <div class="step-line"></div>
                <button type="button" class="step-btn">Agreement</button>
            </div>



            <div class="card-box">
                <div class="card-header">
                    <button class="back-btn" type="button" aria-label="Back">
                        <img src="/images/arrow.png" alt="Back Arrow">
                    </button>
                    <h1><span>Partner</span> Information</h1>
                </div>
                <div class="partner-card">
                    <form id="partnerForm" class="needs-validation" novalidate>
                        <div class="form-step active" data-step="1">
                            <p class="text-center head-text">I Am</p>
                            <div class="mb-4">
                                <div class="iam-buttons">
                                    <button type="button" class="iam-btn active" data-type="rera">Dubai Rera Certified
                                        Agency</button>
                                    <button type="button" class="iam-btn" data-type="other">Other Agencies</button>
                                    <button type="button" class="iam-btn" data-type="individual">Individual</button>
                                </div>
                            </div>

                    <div class="form-grid">
                        <div>
                            <label class="form-label" for="email">Email*</label>
                            <input type="email" class="form-control" id="email" placeholder="Put your email" required>
                            <div class="invalid-feedback">Please enter a valid email.</div>
                        </div>
                        <div>
                            <label class="form-label" for="phone">Phone Number*</label>
                            <input type="tel" class="form-control" id="phone" placeholder="Put your number" required>
                            <div class="invalid-feedback">Please enter your phone number.</div>
                        </div>
                        <div>
                            <label class="form-label" for="country">Country</label>
                            <div class="select-box">
                                <select class="form-select" id="country" required>
                                <option value="">Choose the country</option>
                                <option>United Arab Emirates</option>
                                <option>Saudi Arabia</option>
                                <option>Qatar</option>
                                <option>Kuwait</option>
                            </select>
                            <i class="fa-solid fa-angle-down"></i>
                            </div>
                            <div class="invalid-feedback">Please choose a country.</div>
                        </div>
                        <div>
                            <label class="form-label" for="emirate">Emirate / City</label>
                            <div class="select-box">
                                <select class="form-select" id="emirate" required>
                                <option value="">Choose the emirate</option>
                                <option>Dubai</option>
                                <option>Abu Dhabi</option>
                                <option>Sharjah</option>
                                <option>Ajman</option>
                            </select>
                            <i class="fa-solid fa-angle-down"></i>
                            </div>
                            <div class="invalid-feedback">Please choose an emirate or city.</div>
                        </div>
                    </div>

                    <div class="doc-section active" data-section="rera">
                        <div class="form-grid">
                            <div>
                                <label class="form-label" for="businessLicense">Business License</label>
                                <div class="file-field">
                                    <span class="file-name" data-placeholder="Upload business license">Upload
                                        business
                                        license</span>
                                    <span class="file-icon" aria-hidden="true">
                                        <img src="/images/file.png" alt="file icon">
                                    </span>
                                    <input type="file" id="businessLicense" required>
                                </div>
                                <div class="invalid-feedback">Upload the business license.</div>
                            </div>
                            <div>
                                <label class="form-label" for="orn">Orn Certificate</label>
                                <div class="file-field">
                                    <span class="file-name" data-placeholder="Upload orn certificate">Upload orn
                                        certificate</span>
                                    <span class="file-icon" aria-hidden="true">
                                        <img src="/images/file.png" alt="file icon">
                                    </span>
                                    <input type="file" id="orn" required>
                                </div>
                                <div class="invalid-feedback">Upload the ORN certificate.</div>
                            </div>
                            <div>
                                <label class="form-label" for="vat">Vat Certificate</label>
                                <div class="file-field">
                                    <span class="file-name" data-placeholder="Upload vat certificate">Upload vat
                                        certificate</span>
                                    <span class="file-icon" aria-hidden="true">
                                        <img src="/images/file.png" alt="file icon">
                                    </span>
                                    <input type="file" id="vat" required>
                                </div>
                                <div class="invalid-feedback">Upload the VAT certificate.</div>
                            </div>
                        </div>
                    </div>

                    <div class="doc-section" data-section="other">
                        <div class="form-grid">
                            <div>
                                <label class="form-label" for="businessLicenseOther">Business License</label>
                                <div class="file-field">
                                    <span class="file-name" data-placeholder="Upload business license">Upload
                                        business
                                        license</span>
                                    <span class="file-icon" aria-hidden="true">
                                        <img src="/images/file.png" alt="file icon">
                                    </span>
                                    <input type="file" id="businessLicenseOther">
                                </div>
                                <div class="invalid-feedback">Upload the business license.</div>
                            </div>
                            <div>
                                <label class="form-label" for="ornOther">Orn Certificate</label>
                                <div class="file-field">
                                    <span class="file-name" data-placeholder="Upload orn certificate">Upload orn
                                        certificate</span>
                                    <span class="file-icon" aria-hidden="true">
                                        <img src="/images/file.png" alt="file icon">
                                    </span>
                                    <input type="file" id="ornOther">
                                </div>
                                <div class="invalid-feedback">Upload the ORN certificate.</div>
                            </div>
                            <div>
                                <label class="form-label" for="vatOther">Vat Certificate</label>
                                <div class="file-field">
                                    <span class="file-name" data-placeholder="Upload vat certificate">Upload vat
                                        certificate</span>
                                    <span class="file-icon" aria-hidden="true">
                                        <img src="/images/file.png" alt="file icon">
                                    </span>
                                    <input type="file" id="vatOther">
                                </div>
                                <div class="invalid-feedback">Upload the VAT certificate.</div>
                            </div>
                            <div>
                                <label class="form-label" for="moa">Moa</label>
                                <div class="file-field">
                                    <span class="file-name" data-placeholder="Upload moa certificate">Upload moa
                                        certificate</span>
                                    <span class="file-icon" aria-hidden="true">
                                        <img src="/images/file.png" alt="file icon">
                                    </span>
                                    <input type="file" id="moa">
                                </div>
                                <div class="invalid-feedback">Upload the MOA certificate.</div>
                            </div>
                        </div>
                    </div>

                    <div class="doc-section" data-section="individual">
                        <div class="form-grid">
                            <div>
                                <label class="form-label" for="passport">Passport</label>
                                <div class="file-field">
                                    <span class="file-name" data-placeholder="Upload passport">Upload
                                        passport</span>
                                    <span class="file-icon" aria-hidden="true">
                                        <img src="/images/file.png" alt="file icon">
                                    </span>
                                    <input type="file" id="passport">
                                </div>
                                <div class="invalid-feedback">Upload the passport.</div>
                            </div>
                            <div>
                                <label class="form-label" for="eid">Eid</label>
                                <div class="file-field">
                                    <span class="file-name" data-placeholder="Upload eid">Upload eid</span>
                                    <span class="file-icon" aria-hidden="true">
                                        <img src="/images/file.png" alt="file icon">
                                    </span>
                                    <input type="file" id="eid">
                                </div>
                                <div class="invalid-feedback">Upload the EID.</div>
                            </div>
                        </div>
                    </div>

                    <div class="submit-wrap">
                        <button type="button" class="proceed-btn" data-action="next">Click to Proceed</button>
                    </div>
                </div>

                <div class="form-step" data-step="2">
                    <div class="step-two-panel" data-panel="agency">
                        <div class="form-grid">
                            <div>
                                <label class="form-label" for="agencyName">Agency Name</label>
                                <input type="text" class="form-control" id="agencyName" placeholder="Put the name"
                                    data-step-two="agency">
                                <div class="invalid-feedback">Please enter the agency name.</div>
                            </div>
                            <div>
                                <label class="form-label" for="licenseNumber">License Number</label>
                                <input type="text" class="form-control" id="licenseNumber" placeholder="Put the number"
                                    data-step-two="agency">
                                <div class="invalid-feedback">Please enter the license number.</div>
                            </div>
                            <div>
                                <label class="form-label" for="licenseIssueDate">License Issue Date</label>
                                <div class="date-field">
                                    <input type="text" class="form-control date-display" id="licenseIssueDate"
                                        placeholder="MM.DD.YY" readonly pattern="\d{2}\.\d{2}\.\d{2}"
                                        data-step-two="agency">
                                    <input type="date" class="date-input" aria-hidden="true" tabindex="-1">
                                    <button type="button" class="calendar-btn" aria-label="Open calendar">
                                        <i class="fa-regular fa-calendar" aria-hidden="true"></i>
                                    </button>
                                </div>
                                <div class="invalid-feedback">Please select a valid date (MM.DD.YY).</div>
                            </div>
                            <div>
                                <label class="form-label" for="licenseExpiryDate">License Expiry Date</label>
                                <div class="date-field">
                                    <input type="text" class="form-control date-display" id="licenseExpiryDate"
                                        placeholder="MM.DD.YY" readonly pattern="\d{2}\.\d{2}\.\d{2}"
                                        data-step-two="agency">
                                    <input type="date" class="date-input" aria-hidden="true" tabindex="-1">
                                    <button type="button" class="calendar-btn" aria-label="Open calendar">
                                        <i class="fa-regular fa-calendar" aria-hidden="true"></i>
                                    </button>
                                </div>
                                <div class="invalid-feedback">Please select a valid date (MM.DD.YY).</div>
                            </div>
                            <div>
                                <label class="form-label" for="ornCertificateNumber">Orn Certificate Number</label>
                                <input type="text" class="form-control" id="ornCertificateNumber"
                                    placeholder="Put the number" data-step-two="agency">
                                <div class="invalid-feedback">Please enter the ORN certificate number.</div>
                            </div>
                        </div>
                    </div>

                    <div class="step-two-panel" data-panel="individual">
                        <div class="form-grid">
                            <div>
                                <label class="form-label" for="individualName">Name</label>
                                <input type="text" class="form-control" id="individualName" placeholder="Put the name"
                                    data-step-two="individual">
                                <div class="invalid-feedback">Please enter the name.</div>
                            </div>
                            <div>
                                <label class="form-label" for="individualNationality">Nationality</label>
                                <input type="text" class="form-control" id="individualNationality"
                                    placeholder="Nationality" data-step-two="individual">
                                <div class="invalid-feedback">Please enter the nationality.</div>
                            </div>
                            <div>
                                <label class="form-label" for="passportNumber">Passport Number</label>
                                <input type="text" class="form-control" id="passportNumber" placeholder="0000000"
                                    data-step-two="individual">
                                <div class="invalid-feedback">Please enter the passport number.</div>
                            </div>
                            <div aria-hidden="true"></div>
                            <div>
                                <label class="form-label" for="passportIssueDate">Passport Issue Date</label>
                                <div class="date-field">
                                    <input type="text" class="form-control date-display" id="passportIssueDate"
                                        placeholder="MM.DD.YY" readonly pattern="\d{2}\.\d{2}\.\d{2}"
                                        data-step-two="individual">
                                    <input type="date" class="date-input" aria-hidden="true" tabindex="-1">
                                    <button type="button" class="calendar-btn" aria-label="Open calendar">
                                        <i class="fa-regular fa-calendar" aria-hidden="true"></i>
                                    </button>
                                </div>
                                <div class="invalid-feedback">Please select a valid date (MM.DD.YY).</div>
                            </div>
                            <div>
                                <label class="form-label" for="passportExpiryDate">Passport Expiry Date</label>
                                <div class="date-field">
                                    <input type="text" class="form-control date-display" id="passportExpiryDate"
                                        placeholder="MM.DD.YY" readonly pattern="\d{2}\.\d{2}\.\d{2}"
                                        data-step-two="individual">
                                    <input type="date" class="date-input" aria-hidden="true" tabindex="-1">
                                    <button type="button" class="calendar-btn" aria-label="Open calendar">
                                        <i class="fa-regular fa-calendar" aria-hidden="true"></i>
                                    </button>
                                </div>
                                <div class="invalid-feedback">Please select a valid date (MM.DD.YY).</div>
                            </div>
                            <div>
                                <label class="form-label" for="eidNumber">Eid Number</label>
                                <input type="text" class="form-control" id="eidNumber" placeholder="785-548995874-1"
                                    data-step-two="individual">
                                <div class="invalid-feedback">Please enter the EID number.</div>
                            </div>
                            <div>
                                <label class="form-label" for="eidExpiryDate">Eid Expiry Date</label>
                                <div class="date-field">
                                    <input type="text" class="form-control date-display" id="eidExpiryDate"
                                        placeholder="MM.DD.YY" readonly pattern="\d{2}\.\d{2}\.\d{2}"
                                        data-step-two="individual">
                                    <input type="date" class="date-input" aria-hidden="true" tabindex="-1">
                                    <button type="button" class="calendar-btn" aria-label="Open calendar">
                                        <i class="fa-regular fa-calendar" aria-hidden="true"></i>
                                    </button>
                                </div>
                                <div class="invalid-feedback">Please select a valid date (MM.DD.YY).</div>
                            </div>
                        </div>
                    </div>

                    <div class="submit-wrap">
                        <button type="submit" class="proceed-btn">Confirm and Proceed</button>
                    </div>
                </div>
            </form>
            </div>
            </div>

        </div>

    </div>

    <script>
        const typeButtons = document.querySelectorAll(".iam-btn");
        const sections = document.querySelectorAll(".doc-section");
        const form = document.getElementById("partnerForm");
        const stepWrappers = document.querySelectorAll(".form-step");
        const stepTwoPanels = document.querySelectorAll(".step-two-panel");
        const stepTwoAgencyFields = document.querySelectorAll("[data-step-two='agency']");
        const stepTwoIndividualFields = document.querySelectorAll("[data-step-two='individual']");
        const nextButton = document.querySelector("[data-action='next']");
        const backButton = document.querySelector(".back-btn");
        let currentStep = 1;
        let activeType = "rera";
        const dateFields = document.querySelectorAll(".date-field");

        const formatDateShort = (value) => {
            if (!value) {
                return "";
            }
            const parts = value.split("-");
            if (parts.length !== 3) {
                return "";
            }
            const [year, month, day] = parts;
            if (!year || !month || !day) {
                return "";
            }
            return `${month}.${day}.${year.slice(-2)}`;
        };

        const requiredMap = {
            rera: ["businessLicense", "orn", "vat"],
            other: ["businessLicenseOther", "ornOther", "vatOther", "moa"],
            individual: ["passport", "eid"]
        };

        const updateRequired = (type) => {
            Object.values(requiredMap).flat().forEach((id) => {
                const field = document.getElementById(id);
                if (field) {
                    field.required = false;
                }
            });

            requiredMap[type].forEach((id) => {
                const field = document.getElementById(id);
                if (field) {
                    field.required = true;
                }
            });
        };

        const updateFileValidation = () => {
            document.querySelectorAll(".file-field").forEach((field) => {
                const input = field.querySelector("input[type='file']");
                const feedback = field.parentElement.querySelector(".invalid-feedback");
                const showInvalid = form.classList.contains("was-validated") && input.required && !input.files.length;
                field.classList.toggle("is-invalid", showInvalid);
                if (feedback) {
                    feedback.classList.toggle("d-block", showInvalid);
                }
            });
        };

        const updateStepTwoState = () => {
            const isStepTwo = currentStep === 2;
            const isIndividual = activeType === "individual";
            stepTwoPanels.forEach((panel) => {
                panel.classList.toggle("active", panel.dataset.panel === (isIndividual ? "individual" : "agency"));
            });
            stepTwoAgencyFields.forEach((field) => {
                const shouldEnable = isStepTwo && !isIndividual;
                field.disabled = !shouldEnable;
                field.required = shouldEnable;
            });
            stepTwoIndividualFields.forEach((field) => {
                const shouldEnable = isStepTwo && isIndividual;
                field.disabled = !shouldEnable;
                field.required = shouldEnable;
            });
        };

        const setStep = (step) => {
            currentStep = step;
            stepWrappers.forEach((wrapper) => {
                wrapper.classList.toggle("active", Number(wrapper.dataset.step) === step);
            });
            updateStepTwoState();
            if (backButton) {
                backButton.classList.toggle("is-disabled", step === 1);
                backButton.disabled = step === 1;
            }
            form.classList.remove("was-validated");
            updateFileValidation();
        };

        const setActiveType = (type) => {
            activeType = type;
            typeButtons.forEach((btn) => {
                btn.classList.toggle("active", btn.dataset.type === type);
            });
            sections.forEach((section) => {
                section.classList.toggle("active", section.dataset.section === type);
            });
            updateRequired(type);
            updateFileValidation();
            updateStepTwoState();
        };

        typeButtons.forEach((btn) => {
            btn.addEventListener("click", () => {
                setActiveType(btn.dataset.type);
            });
        });

        document.querySelectorAll(".file-field input[type='file']").forEach((input) => {
            input.addEventListener("change", (event) => {
                const nameEl = event.target.closest(".file-field").querySelector(".file-name");
                const file = event.target.files[0];
                nameEl.textContent = file ? file.name : nameEl.dataset.placeholder;
                updateFileValidation();
            });
        });

        dateFields.forEach((field) => {
            const display = field.querySelector(".date-display");
            const picker = field.querySelector("input[type='date']");
            const button = field.querySelector(".calendar-btn");
            if (!display || !picker || !button) {
                return;
            }
            const syncDisplay = () => {
                display.value = formatDateShort(picker.value);
            };
            picker.addEventListener("change", syncDisplay);
            button.addEventListener("click", () => {
                if (typeof picker.showPicker === "function") {
                    picker.showPicker();
                } else {
                    picker.focus();
                    picker.click();
                }
            });
            syncDisplay();
        });

        if (nextButton) {
            nextButton.addEventListener("click", () => {
                if (!form.checkValidity()) {
                    form.classList.add("was-validated");
                    updateFileValidation();
                    return;
                }
                setStep(2);
            });
        }

        if (backButton) {
            backButton.addEventListener("click", () => {
                if (currentStep === 2) {
                    setStep(1);
                }
            });
        }

        form.addEventListener("submit", (event) => {
            if (currentStep === 1) {
                event.preventDefault();
                if (form.checkValidity()) {
                    setStep(2);
                } else {
                    form.classList.add("was-validated");
                    updateFileValidation();
                }
                return;
            }

            if (!form.checkValidity()) {
                event.preventDefault();
                event.stopPropagation();
            }
            form.classList.add("was-validated");
            updateFileValidation();
        });

        setActiveType("rera");
        setStep(1);
    </script>
</body>

</html>
